<div class="book-ride-container">
  <div class="header">
    <h2>üöó Book a Ride</h2>
    <p>Enter your trip details to find available drivers</p>
  </div>

  <!-- Location Selection Step -->
  <div class="booking-step" *ngIf="currentStep === 'location'">
    <div class="step-indicator">
      <div class="step active">1. Location</div>
      <div class="step">2. Vehicle</div>
      <div class="step">3. Confirm</div>
    </div>

    <div class="booking-form">
      <div class="form-group">
        <label for="pickup">üìç Pickup Location</label>
        <input 
          id="pickup"
          type="text" 
          [(ngModel)]="pickupLocation" 
          placeholder="Enter pickup location"
          class="form-input">
        <div class="suggestions" *ngIf="pickupLocation">
          <div *ngFor="let location of locationSuggestions" 
               class="suggestion-item"
               (click)="selectLocationSuggestion(location, 'pickup')">
            <div class="suggestion-name">{{location.name}}</div>
            <div class="suggestion-address">{{location.address}}</div>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="destination">üéØ Destination</label>
        <input 
          id="destination"
          type="text" 
          [(ngModel)]="destinationLocation" 
          placeholder="Enter destination"
          class="form-input">
        <div class="suggestions" *ngIf="destinationLocation">
          <div *ngFor="let location of locationSuggestions" 
               class="suggestion-item"
               (click)="selectLocationSuggestion(location, 'destination')">
            <div class="suggestion-name">{{location.name}}</div>
            <div class="suggestion-address">{{location.address}}</div>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>
            <input type="checkbox" [(ngModel)]="isScheduled"> Schedule for later
          </label>
        </div>
      </div>

      <div class="form-row" *ngIf="isScheduled">
        <div class="form-group">
          <label for="date">üìÖ Date</label>
          <input 
            id="date"
            type="date" 
            [(ngModel)]="selectedDate" 
            class="form-input">
        </div>

        <div class="form-group">
          <label for="time">üïê Time</label>
          <input 
            id="time"
            type="time" 
            [(ngModel)]="selectedTime" 
            class="form-input">
        </div>
      </div>

      <button 
        class="primary-btn" 
        (click)="proceedToVehicleSelection()"
        [disabled]="!pickupLocation || !destinationLocation">
        Continue to Vehicle Selection
      </button>
    </div>
  </div>

  <!-- Vehicle Selection Step -->
  <div class="booking-step" *ngIf="currentStep === 'vehicle'">
    <div class="step-indicator">
      <div class="step completed">1. Location</div>
      <div class="step active">2. Vehicle</div>
      <div class="step">3. Confirm</div>
    </div>

    <div class="trip-summary">
      <h3>Trip Summary</h3>
      <p><strong>From:</strong> {{pickupLocation}}</p>
      <p><strong>To:</strong> {{destinationLocation}}</p>
      <p><strong>Distance:</strong> {{estimatedDistance}}</p>
      <p><strong>Duration:</strong> {{estimatedDuration}}</p>
    </div>

    <div class="vehicle-selection">
      <h3>Select Vehicle Type</h3>
      <div class="vehicle-options">
        <div *ngFor="let vehicle of vehicleTypes" 
             class="vehicle-card" 
             [class.selected]="selectedVehicleType === vehicle.id"
             (click)="selectVehicleType(vehicle)">
          <div class="vehicle-icon">{{vehicle.icon}}</div>
          <div class="vehicle-details">
            <h4>{{vehicle.name}}</h4>
            <p>Capacity: {{vehicle.capacity}} people</p>
            <p>ETA: {{vehicle.estimatedTime}}</p>
          <p class="fare-estimate">{{formatCurrency(calculateVehicleFare(vehicle))}}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="action-buttons">
      <button class="secondary-btn" (click)="goBack()">Back</button>
      <button 
        class="primary-btn" 
        (click)="proceedToConfirmation()"
        [disabled]="!selectedVehicleType">
        Continue to Confirmation
      </button>
    </div>
  </div>

  <!-- Confirmation Step -->
  <div class="booking-step" *ngIf="currentStep === 'confirmation'">
    <div class="step-indicator">
      <div class="step completed">1. Location</div>
      <div class="step completed">2. Vehicle</div>
      <div class="step active">3. Confirm</div>
    </div>

    <div class="confirmation-details">
      <h3>Confirm Your Ride</h3>
      
      <div class="trip-details">
        <div class="detail-row">
          <span class="label">From:</span>
          <span class="value">{{pickupLocation}}</span>
        </div>
        <div class="detail-row">
          <span class="label">To:</span>
          <span class="value">{{destinationLocation}}</span>
        </div>
        <div class="detail-row">
          <span class="label">Vehicle:</span>
          <span class="value">{{getVehicleTypeById(selectedVehicleType)?.name}}</span>
        </div>
        <div class="detail-row">
          <span class="label">Distance:</span>
          <span class="value">{{estimatedDistance}}</span>
        </div>
        <div class="detail-row">
          <span class="label">Estimated Fare:</span>
          <span class="value fare">{{formatCurrency(estimatedFare)}}</span>
        </div>
        <div *ngIf="isScheduled && scheduledTime" class="detail-row">
          <span class="label">Scheduled Time:</span>
          <span class="value">{{scheduledTime}}</span>
        </div>
      </div>

      <div class="notes-section">
        <label for="rideNotes">Special Instructions (optional):</label>
        <textarea 
          id="rideNotes"
          [(ngModel)]="rideNotes" 
          placeholder="Any special instructions for the driver..."
          class="form-textarea"></textarea>
      </div>
    </div>

    <div class="action-buttons">
      <button class="secondary-btn" (click)="goBack()">Back</button>
      <button 
        class="primary-btn" 
        (click)="confirmBooking()"
        [disabled]="isLoading">
        <span *ngIf="!isLoading">Confirm Booking</span>
        <span *ngIf="isLoading">Processing...</span>
      </button>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Processing your booking...</p>
  </div>
</div>